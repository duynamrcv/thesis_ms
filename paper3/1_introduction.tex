\section{Introduction}
Formation control of multiple robots is gaining importance due to its capability to perform challenging tasks in complex environments such as disaster response, search and rescue, tracking of multiple targets, and swarm-based reconnaissance~\cite{9306908,Oh2015}. It also enhances system resilience as the malfunction of a certain robot can be overcome by reconfiguring the swarm formation. Reconfiguration is also essential for a robot swarm to work in complex environments where a fixed topology is insufficient for the robots to navigate through. Formation reconfiguration control therefore plays a key role in the functioning operation of a robot swarm.

In formation control, a popular approach is based on natural formation collectives, such as school of fish or flocking of birds~\cite {Nagy2010}, in which their motion is driven by a set of simple behaviors, including repulsion that steers an agent away from its neighbors, cohesion that attracts the agent to the group, migration that orients its motion in a preferred direction, and additional repulsion from obstacles to avoid collisions with the environment~\cite{Reynolds1987}. Those behaviors are often integrated with artificial potential fields to produce control signals for swarm robots (APF)~\cite{736776,Berlinger2021,9565893}. In~\cite{736776}, formation and navigational behaviors are combined as concurrent
asynchronous processes to guide a robot group to reach their goals with a desired formation shape while avoiding collision. In~\cite{Berlinger2021}, 3D collective behaviors are used to control a swarm of fish-inspired miniature underwater robots without having direct communication. The AFP is used to coordinate these behaviors to obtain collective capabilities among the robots. The behavior-based methods, however, are insufficient in adapting to changes in environmental conditions, especially in narrow spaces, since they introduce an abrupt change in the potential fields~\cite{Zhang2023}.

Several improvements based on a hybrid approach have been proposed to address the adaptation issue. In~\cite{Elkilany2020}, The APF method is combined with an artificial neural network to optimize potential force parameters for better adaptation of the robot swarm to environmental conditions. In~\cite{Vsrhelyi2018}, an evolutionary optimization framework is introduced to select appropriate parameters and fitness functions to maximize the velocity and cohesion of the swarm. While this parametric optimization APF-based approach adjusts the parameters of behavioral functions to modify their formation shape according to environmental conditions, sudden changes in narrow environments lead to conflicts between maintaining the formation and avoiding collision behaviors, making parameter optimization insufficient to fully address the issue. 

Recently, an approach based on optimal control has been introduced with the capability of predicting agents' states and handling swarm constraints for reliable formation~\cite{Beaver2021,Soria2021,8950150}. In~\cite{7828016,Wu2020}, optimization-based motion planners are employed with the introduction of individual point-to-point transitions to avoid collisions in multi-robot systems. In~\cite{Soria2021}, a swarm navigation method using model predictive control (MPC) is proposed for a group of drones. It employs cost functions and constraints to maintain speed, ensure safety, and navigate the drones in the environment. The system however is centralized, which is dependent on a main agent. A distributed MPC is introduced in~\cite{9562281} for homogeneous robots, demonstrating the possibility of utilizing decentralized computation for formation control. Nonetheless, this approach is only feasible for the environment with sufficient large space. Maintaining formation while moving through tight environments poses a high risk of collision due to the conflict between preserving the formation shape and avoiding obstacles.

These challenges lead to the need for control techniques that can quickly adjust the formation topology in response to sudden changes in the environment. In~\cite{AlonsoMora2018}, a distributed consensus mechanism that enables new formation shapes is introduced for narrow environments with both static and dynamic obstacles. A convex hull of robot positions is computed to determine their minimum/maximum positions in the desired movement direction, allowing for assigning robots to relevant positions within the formation. However, the transition is conducted by reassigning robots to virtual points on the reference formation rather than relying on information obtained from the environment. In~\cite{9981858}, affine transformations are used to change the formation shapes to avoid obstacles in dense environments. However, it requires information to be shared among all the robots in the formation. Our previous work~\cite{10417519} employs a V-shape formation and real-time information on obstacles to maneuver the robot swarm to a narrow corridor. The two wings of the V-shape can be expanded or contracted to form suitable shapes depending on the width of the narrow passage. Nevertheless, these approaches have not considered the physical limits of the robots, which could lead to infeasible control inputs and unexpected collisions in certain scenarios. Furthermore, the ability of each robot to make decisions based on environmental information remains limited.

Motivated by the ongoing progress and technological advancements in multi-robot formation applications across various real-world scenarios, this paper aims to design an optimal formation reconfiguration control strategy for safe and effective operation of a decentralized multi-robot team in cluttered environments. The contributions can be summarized as threefold:
\begin{enumerate}
    \item A perceptual formation reconfiguration control strategy is proposed to effectively navigate a multi-robot formation moving through narrow environments. Each robot is equipped with local sensors and communication modules to collect information from the surrounding environment and its neighbors for distributed decision-making. The formation thus can be shrunk/expanded or transformed to the line formation according to the environment.
        \item A model prediction-based control strategy is proposed to achieve the navigation requirements of maintaining formation, velocity, and direction, while effectively avoiding collisions. The proposed method models these objectives and constraints into fitness functions that can be easily expanded and deployed to multiple robots simultaneously.
    \item The feasibility and effectiveness of the proposed strategy are demonstrated by simulation and comparison results. A software-in-the-loop experiment was also implemented using flying robots to validate abilities in real-world applications. We also release the source code of the proposed strategy.
\end{enumerate}

The remaining sections of this paper are organized as follows. Section~\ref{sec:problem} describes the formation model. Section~\ref{sec:propose} presents the proposed formation reconfiguration control method. Section~\ref{sec:result} shows simulations, comparisons, and software-in-the-loop experimental results. The paper ends with conclusions drawn in Section~\ref{sec:conclusion}.
